unexpected = ["backbone_net.model._bn0.weight", "backbone_net.model._bn0.bias", "backbone_net.model._bn0.running_mean", "backbone_net.model._bn0.running_var", "backbone_net.model._bn0.num_batches_tracked", "backbone_net.model._blocks.0._bn1.weight", "backbone_net.model._blocks.0._bn1.bias", "backbone_net.model._blocks.0._bn1.running_mean", "backbone_net.model._blocks.0._bn1.running_var", "backbone_net.model._blocks.0._bn1.num_batches_tracked", "backbone_net.model._blocks.0._bn2.weight", "backbone_net.model._blocks.0._bn2.bias", "backbone_net.model._blocks.0._bn2.running_mean", "backbone_net.model._blocks.0._bn2.running_var", "backbone_net.model._blocks.0._bn2.num_batches_tracked", "backbone_net.model._blocks.1._bn0.weight", "backbone_net.model._blocks.1._bn0.bias", "backbone_net.model._blocks.1._bn0.running_mean", "backbone_net.model._blocks.1._bn0.running_var", "backbone_net.model._blocks.1._bn0.num_batches_tracked", "backbone_net.model._blocks.1._bn1.weight", "backbone_net.model._blocks.1._bn1.bias", "backbone_net.model._blocks.1._bn1.running_mean", "backbone_net.model._blocks.1._bn1.running_var", "backbone_net.model._blocks.1._bn1.num_batches_tracked", "backbone_net.model._blocks.1._bn2.weight", "backbone_net.model._blocks.1._bn2.bias", "backbone_net.model._blocks.1._bn2.running_mean", "backbone_net.model._blocks.1._bn2.running_var", "backbone_net.model._blocks.1._bn2.num_batches_tracked", "backbone_net.model._blocks.2._bn0.weight", "backbone_net.model._blocks.2._bn0.bias", "backbone_net.model._blocks.2._bn0.running_mean", "backbone_net.model._blocks.2._bn0.running_var", "backbone_net.model._blocks.2._bn0.num_batches_tracked", "backbone_net.model._blocks.2._bn1.weight", "backbone_net.model._blocks.2._bn1.bias", "backbone_net.model._blocks.2._bn1.running_mean", "backbone_net.model._blocks.2._bn1.running_var", "backbone_net.model._blocks.2._bn1.num_batches_tracked", "backbone_net.model._blocks.2._bn2.weight", "backbone_net.model._blocks.2._bn2.bias", "backbone_net.model._blocks.2._bn2.running_mean", "backbone_net.model._blocks.2._bn2.running_var", "backbone_net.model._blocks.2._bn2.num_batches_tracked", "backbone_net.model._blocks.3._bn0.weight", "backbone_net.model._blocks.3._bn0.bias", "backbone_net.model._blocks.3._bn0.running_mean", "backbone_net.model._blocks.3._bn0.running_var", "backbone_net.model._blocks.3._bn0.num_batches_tracked", "backbone_net.model._blocks.3._bn1.weight", "backbone_net.model._blocks.3._bn1.bias", "backbone_net.model._blocks.3._bn1.running_mean", "backbone_net.model._blocks.3._bn1.running_var", "backbone_net.model._blocks.3._bn1.num_batches_tracked", "backbone_net.model._blocks.3._bn2.weight", "backbone_net.model._blocks.3._bn2.bias", "backbone_net.model._blocks.3._bn2.running_mean", "backbone_net.model._blocks.3._bn2.running_var", "backbone_net.model._blocks.3._bn2.num_batches_tracked", "backbone_net.model._blocks.4._bn0.weight", "backbone_net.model._blocks.4._bn0.bias", "backbone_net.model._blocks.4._bn0.running_mean", "backbone_net.model._blocks.4._bn0.running_var", "backbone_net.model._blocks.4._bn0.num_batches_tracked", "backbone_net.model._blocks.4._bn1.weight", "backbone_net.model._blocks.4._bn1.bias", "backbone_net.model._blocks.4._bn1.running_mean", "backbone_net.model._blocks.4._bn1.running_var", "backbone_net.model._blocks.4._bn1.num_batches_tracked", "backbone_net.model._blocks.4._bn2.weight", "backbone_net.model._blocks.4._bn2.bias", "backbone_net.model._blocks.4._bn2.running_mean", "backbone_net.model._blocks.4._bn2.running_var", "backbone_net.model._blocks.4._bn2.num_batches_tracked", "backbone_net.model._blocks.5._bn0.weight", "backbone_net.model._blocks.5._bn0.bias", "backbone_net.model._blocks.5._bn0.running_mean", "backbone_net.model._blocks.5._bn0.running_var", "backbone_net.model._blocks.5._bn0.num_batches_tracked", "backbone_net.model._blocks.5._bn1.weight", "backbone_net.model._blocks.5._bn1.bias", "backbone_net.model._blocks.5._bn1.running_mean", "backbone_net.model._blocks.5._bn1.running_var", "backbone_net.model._blocks.5._bn1.num_batches_tracked", "backbone_net.model._blocks.5._bn2.weight", "backbone_net.model._blocks.5._bn2.bias", "backbone_net.model._blocks.5._bn2.running_mean", "backbone_net.model._blocks.5._bn2.running_var", "backbone_net.model._blocks.5._bn2.num_batches_tracked", "backbone_net.model._blocks.6._bn0.weight", "backbone_net.model._blocks.6._bn0.bias", "backbone_net.model._blocks.6._bn0.running_mean", "backbone_net.model._blocks.6._bn0.running_var", "backbone_net.model._blocks.6._bn0.num_batches_tracked", "backbone_net.model._blocks.6._bn1.weight", "backbone_net.model._blocks.6._bn1.bias", "backbone_net.model._blocks.6._bn1.running_mean", "backbone_net.model._blocks.6._bn1.running_var", "backbone_net.model._blocks.6._bn1.num_batches_tracked", "backbone_net.model._blocks.6._bn2.weight", "backbone_net.model._blocks.6._bn2.bias", "backbone_net.model._blocks.6._bn2.running_mean", "backbone_net.model._blocks.6._bn2.running_var", "backbone_net.model._blocks.6._bn2.num_batches_tracked", "backbone_net.model._blocks.7._bn0.weight", "backbone_net.model._blocks.7._bn0.bias", "backbone_net.model._blocks.7._bn0.running_mean", "backbone_net.model._blocks.7._bn0.running_var", "backbone_net.model._blocks.7._bn0.num_batches_tracked", "backbone_net.model._blocks.7._bn1.weight", "backbone_net.model._blocks.7._bn1.bias", "backbone_net.model._blocks.7._bn1.running_mean", "backbone_net.model._blocks.7._bn1.running_var", "backbone_net.model._blocks.7._bn1.num_batches_tracked", "backbone_net.model._blocks.7._bn2.weight", "backbone_net.model._blocks.7._bn2.bias", "backbone_net.model._blocks.7._bn2.running_mean", "backbone_net.model._blocks.7._bn2.running_var", "backbone_net.model._blocks.7._bn2.num_batches_tracked", "backbone_net.model._blocks.8._bn0.weight", "backbone_net.model._blocks.8._bn0.bias", "backbone_net.model._blocks.8._bn0.running_mean", "backbone_net.model._blocks.8._bn0.running_var", "backbone_net.model._blocks.8._bn0.num_batches_tracked", "backbone_net.model._blocks.8._bn1.weight", "backbone_net.model._blocks.8._bn1.bias", "backbone_net.model._blocks.8._bn1.running_mean", "backbone_net.model._blocks.8._bn1.running_var", "backbone_net.model._blocks.8._bn1.num_batches_tracked", "backbone_net.model._blocks.8._bn2.weight", "backbone_net.model._blocks.8._bn2.bias", "backbone_net.model._blocks.8._bn2.running_mean", "backbone_net.model._blocks.8._bn2.running_var", "backbone_net.model._blocks.8._bn2.num_batches_tracked", "backbone_net.model._blocks.9._bn0.weight", "backbone_net.model._blocks.9._bn0.bias", "backbone_net.model._blocks.9._bn0.running_mean", "backbone_net.model._blocks.9._bn0.running_var", "backbone_net.model._blocks.9._bn0.num_batches_tracked", "backbone_net.model._blocks.9._bn1.weight", "backbone_net.model._blocks.9._bn1.bias", "backbone_net.model._blocks.9._bn1.running_mean", "backbone_net.model._blocks.9._bn1.running_var", "backbone_net.model._blocks.9._bn1.num_batches_tracked", "backbone_net.model._blocks.9._bn2.weight", "backbone_net.model._blocks.9._bn2.bias", "backbone_net.model._blocks.9._bn2.running_mean", "backbone_net.model._blocks.9._bn2.running_var", "backbone_net.model._blocks.9._bn2.num_batches_tracked", "backbone_net.model._blocks.10._bn0.weight", "backbone_net.model._blocks.10._bn0.bias", "backbone_net.model._blocks.10._bn0.running_mean", "backbone_net.model._blocks.10._bn0.running_var", "backbone_net.model._blocks.10._bn0.num_batches_tracked", "backbone_net.model._blocks.10._bn1.weight", "backbone_net.model._blocks.10._bn1.bias", "backbone_net.model._blocks.10._bn1.running_mean", "backbone_net.model._blocks.10._bn1.running_var", "backbone_net.model._blocks.10._bn1.num_batches_tracked", "backbone_net.model._blocks.10._bn2.weight", "backbone_net.model._blocks.10._bn2.bias", "backbone_net.model._blocks.10._bn2.running_mean", "backbone_net.model._blocks.10._bn2.running_var", "backbone_net.model._blocks.10._bn2.num_batches_tracked", "backbone_net.model._blocks.11._bn0.weight", "backbone_net.model._blocks.11._bn0.bias", "backbone_net.model._blocks.11._bn0.running_mean", "backbone_net.model._blocks.11._bn0.running_var", "backbone_net.model._blocks.11._bn0.num_batches_tracked", "backbone_net.model._blocks.11._bn1.weight", "backbone_net.model._blocks.11._bn1.bias", "backbone_net.model._blocks.11._bn1.running_mean", "backbone_net.model._blocks.11._bn1.running_var", "backbone_net.model._blocks.11._bn1.num_batches_tracked", "backbone_net.model._blocks.11._bn2.weight", "backbone_net.model._blocks.11._bn2.bias", "backbone_net.model._blocks.11._bn2.running_mean", "backbone_net.model._blocks.11._bn2.running_var", "backbone_net.model._blocks.11._bn2.num_batches_tracked", "backbone_net.model._blocks.12._bn0.weight", "backbone_net.model._blocks.12._bn0.bias", "backbone_net.model._blocks.12._bn0.running_mean", "backbone_net.model._blocks.12._bn0.running_var", "backbone_net.model._blocks.12._bn0.num_batches_tracked", "backbone_net.model._blocks.12._bn1.weight", "backbone_net.model._blocks.12._bn1.bias", "backbone_net.model._blocks.12._bn1.running_mean", "backbone_net.model._blocks.12._bn1.running_var", "backbone_net.model._blocks.12._bn1.num_batches_tracked", "backbone_net.model._blocks.12._bn2.weight", "backbone_net.model._blocks.12._bn2.bias", "backbone_net.model._blocks.12._bn2.running_mean", "backbone_net.model._blocks.12._bn2.running_var", "backbone_net.model._blocks.12._bn2.num_batches_tracked", "backbone_net.model._blocks.13._bn0.weight", "backbone_net.model._blocks.13._bn0.bias", "backbone_net.model._blocks.13._bn0.running_mean", "backbone_net.model._blocks.13._bn0.running_var", "backbone_net.model._blocks.13._bn0.num_batches_tracked", "backbone_net.model._blocks.13._bn1.weight", "backbone_net.model._blocks.13._bn1.bias", "backbone_net.model._blocks.13._bn1.running_mean", "backbone_net.model._blocks.13._bn1.running_var", "backbone_net.model._blocks.13._bn1.num_batches_tracked", "backbone_net.model._blocks.13._bn2.weight", "backbone_net.model._blocks.13._bn2.bias", "backbone_net.model._blocks.13._bn2.running_mean", "backbone_net.model._blocks.13._bn2.running_var", "backbone_net.model._blocks.13._bn2.num_batches_tracked", "backbone_net.model._blocks.14._bn0.weight", "backbone_net.model._blocks.14._bn0.bias", "backbone_net.model._blocks.14._bn0.running_mean", "backbone_net.model._blocks.14._bn0.running_var", "backbone_net.model._blocks.14._bn0.num_batches_tracked", "backbone_net.model._blocks.14._bn1.weight", "backbone_net.model._blocks.14._bn1.bias", "backbone_net.model._blocks.14._bn1.running_mean", "backbone_net.model._blocks.14._bn1.running_var", "backbone_net.model._blocks.14._bn1.num_batches_tracked", "backbone_net.model._blocks.14._bn2.weight", "backbone_net.model._blocks.14._bn2.bias", "backbone_net.model._blocks.14._bn2.running_mean", "backbone_net.model._blocks.14._bn2.running_var", "backbone_net.model._blocks.14._bn2.num_batches_tracked", "backbone_net.model._blocks.15._bn0.weight", "backbone_net.model._blocks.15._bn0.bias", "backbone_net.model._blocks.15._bn0.running_mean", "backbone_net.model._blocks.15._bn0.running_var", "backbone_net.model._blocks.15._bn0.num_batches_tracked", "backbone_net.model._blocks.15._bn1.weight", "backbone_net.model._blocks.15._bn1.bias", "backbone_net.model._blocks.15._bn1.running_mean", "backbone_net.model._blocks.15._bn1.running_var", "backbone_net.model._blocks.15._bn1.num_batches_tracked", "backbone_net.model._blocks.15._bn2.weight", "backbone_net.model._blocks.15._bn2.bias", "backbone_net.model._blocks.15._bn2.running_mean", "backbone_net.model._blocks.15._bn2.running_var", "backbone_net.model._blocks.15._bn2.num_batches_tracked"]
def add_bn_before_last_dot(strings):
    modified_strings = []
    for string in strings:
        last_dot_index = string.rfind('.')
        if last_dot_index != -1:
            modified_string = string[:last_dot_index] + ".bn" + string[last_dot_index:]
            modified_strings.append(modified_string)
        else:
            modified_strings.append(string)
    return modified_strings
new_key_list = add_bn_before_last_dot(unexpected)

import torch

# Load the state_dict from the .pth file
state_dict = torch.load('/content/QAT_ED_PyTorch/weights/efficientdet-d0_updated')

# Example lists of original and updated keys
original_keys =unexpected

updated_keys =new_key_list

# Update the state_dict keys based on the original and updated keys lists
for original_key, updated_key in zip(original_keys, updated_keys):
    if original_key in state_dict:
        state_dict[updated_key] = state_dict.pop(original_key)

# Save the updated state_dict to a new .pth file
torch.save(state_dict, 'finally_updated_d0_model_weights.pth')
print("Updated state dictionary saved successfully.")
